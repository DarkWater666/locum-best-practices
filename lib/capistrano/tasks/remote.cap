namespace :remote do
  # TODO: move comments to README
  # e.g: 'cap stage logs:tail[logfile]' will tail 'shared_path/log/logfile.log'.
  desc 'Tail logs on remote host'
  task :logs, :file do |_t, args|
    on roles(:app) do |server|
      user = server.user
      params = "#{user}@#{host}"
      file = "#{args[:file] || fetch(:rails_env)}"
      params += %( -t "tail -f /home/#{user}/projects/#{fetch(:application)}/shared/log/#{file}.log")
      exec "ssh #{params}"
    end
  end
end
